angular.module("NUSAP",["ui.bootstrap","ui.router","ngCookies","ngAnimate","ngCookies","anguFixedHeaderTable"]);
"use strict";angular.module("NUSAP").config(["$stateProvider","$urlRouterProvider",function(t,a){a.otherwise("/"),t.state("index",{url:"/",templateUrl:"templates/dashboard.html",js:["js/Chart.HorizontalBar.js","http://www.chartjs.org/assets/Chart.min.js"]}).state("login",{url:"/login",templateUrl:"templates/login.html"}).state("capCal",{url:"/capCal",templateUrl:"templates/capCal.html"})}]);

function getUrlVars(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,n,o){e[n]=o});return e}function AlertsCtrl(e,t,n){n(function(){e.closeAlert(0)},7e3),e.alerts=[{}],e.addAlert=function(){e.alerts.push({msg:"Another alert!"})},e.welcomeUser=function(){var n={method:"GET",url:"index.php?id=profile&token="+token};t(n).then(function(t){e.token=token,e.username=t.data.Results[0].Name,e.msg="WELCOME "+e.username+"!"},function(e){}),e.type="info"},e.closeMsg=function(){e.alert!=e.alert},e.closeAlert=function(t){e.alerts.splice(e.alerts.indexOf(this),1)}}var token;null==sessionStorage.getItem("token")?(token=getUrlVars().token,sessionStorage.setItem("isValidToken",!1)):(token=sessionStorage.getItem("token"),sessionStorage.setItem("isValidToken",!0)),angular.module("NUSAP").controller("AlertsCtrl",["$scope","$http","$timeout",AlertsCtrl]);
function BarCtrl(a,r,o,t){a.getBarChart=function(){var a=document.getElementById("canvas").getContext("2d");new Chart(a).HorizontalBar(barChartData,{responsive:!0,barShowStroke:!1})}}var randomScalingFactor=function(){return Math.round(100*Math.random())},barChartData={labels:["Core","ULR","UE"],datasets:[{fillColor:"#98FB98",strokeColor:"#00FF7F",highlightFill:"#00FF7F",highlightStroke:"#00FF7F",data:[randomScalingFactor(),randomScalingFactor(),randomScalingFactor()]},{fillColor:"#FA8072",strokeColor:"#FA8072",highlightFill:"#E58270",highlightStroke:"#FA8072",data:[randomScalingFactor(),randomScalingFactor(),randomScalingFactor()]}]};angular.module("NUSAP").controller("BarCtrl",["$scope","$cookieStore","$http","$location",BarCtrl]);
function getUrlVars(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,d,s){e[d]=s});return e}function CapCalCtrl(e,t,d,s,o,u){function l(t,d,s){a(t,d,s).then(function(d){if(""!==d.data){var s=[];e.preclusionList.push(t),void 0!==d.data.Preclusion&&(s=d.data.Preclusion.split(","),angular.forEach(s,function(t,d){if(-1==s[d].trim().indexOf("or")&&-1==s[d].trim().indexOf("OR")&&-1==s[d].trim().indexOf("and")&&-1==s[d].trim().indexOf("/"))s[d].trim().length<9&&e.preclusionList.push(s[d].trim());else if(-1!=s[d].trim().indexOf(" or ")){var o=[];o=s[d].trim().split(" or "),angular.forEach(o,function(t,d){if(-1==o[d].indexOf(" OR "))o[d].trim().length<9&&e.preclusionList.push(o[d].trim());else{var s=[];s=o[d].trim().split(" OR "),angular.forEach(s,function(t,d){s[d].trim().length<9&&e.preclusionList.push(s[d].trim())})}})}else if(-1!=s[d].trim().indexOf(" OR ")){var o=[];o=s[d].trim().split(" OR "),angular.forEach(o,function(t,d){o[d].trim().length<9&&e.preclusionList.push(o[d].trim())})}else if(-1!=s[d].trim().indexOf(" and ")){var o=[];o=s[d].trim().split(" and "),angular.forEach(o,function(t,d){o[d].trim().length<9&&e.preclusionList.push(o[d].trim())})}else if(-1!=s[d].trim().indexOf("/")){var o=[];o=s[d].trim().split("/"),angular.forEach(o,function(t,d){o[d].trim().length<9&&e.preclusionList.push(o[d].trim())})}}))}sessionStorage.setItem("preclusionList",JSON.stringify(e.preclusionList))})}function r(t,d,s){a(t,d,s).then(function(d){if(""!==d.data){var s=[];e.preclusionList.splice(e.preclusionList.indexOf(t),1),void 0!==d.data.Preclusion&&(s=d.data.Preclusion.split(","),angular.forEach(s,function(t,d){if(-1==s[d].trim().indexOf("or")&&-1==s[d].trim().indexOf("OR")&&-1==s[d].trim().indexOf("and")&&-1==s[d].trim().indexOf("/"))s[d].trim().length<=9&&e.preclusionList.splice(e.preclusionList.indexOf(s[d].trim()),1);else if(-1!=s[d].trim().indexOf(" or ")){var o=[];o=s[d].trim().split(" or "),angular.forEach(o,function(t,d){if(-1==o[d].indexOf(" OR "))o[d].trim().length<=9&&e.preclusionList.splice(e.preclusionList.indexOf(o[d].trim()),1);else{var s=[];s=o[d].trim().split(" OR "),angular.forEach(s,function(t,d){s[d].trim().length<=9&&e.preclusionList.splice(e.preclusionList.indexOf(s[d].trim()),1)})}})}else if(-1!=s[d].trim().indexOf(" OR ")){var o=[];o=s[d].trim().split(" OR "),angular.forEach(o,function(t,d){o[d].trim().length<=9&&e.preclusionList.splice(e.preclusionList.indexOf(o[d].trim()),1)})}else if(-1!=s[d].trim().indexOf(" and ")){var o=[];o=s[d].trim().split(" and "),angular.forEach(o,function(t,d){o[d].trim().length<=9&&e.preclusionList.splice(e.preclusionList.indexOf(o[d].trim()),1)})}else if(-1!=s[d].trim().indexOf("/")){var o=[];o=s[d].trim().split("/"),angular.forEach(o,function(t,d){o[d].trim().length<=9&&e.preclusionList.splice(e.preclusionList.indexOf(o[d].trim()),1)})}}))}sessionStorage.setItem("preclusionList",JSON.stringify(e.preclusionList))})}function a(e,t,s){return d({method:"GET",url:"index.php?id=checkMod&modCode="+e+"&sem="+t+"&acadYear="+s})}function i(e){return"A+"===e||"A"===e?5:"A-"===e?4.5:"B+"===e?4:"B"===e?3.5:"B-"===e?3:"C+"===e?2.5:"C"===e?2:"D+"===e?1.5:"D"===e?1:0}var n=0,S=0;e.showLoading=!1,u(function(){e.showLoading=!0,sessionStorage.showLoading=!0},3500),e.preclusionList=[],e.preclusionList=[];var c=JSON.parse(sessionStorage.getItem("modsTaken"));angular.forEach(c,function(e,t){l(c[t].ModuleCode.toUpperCase(),c[t].Semester,c[t].AcadYear)}),e.addSemester=function(){var t=[],d=JSON.parse(sessionStorage.getItem("userSem")).length;t=JSON.parse(sessionStorage.getItem("userSem"));var s=JSON.parse(sessionStorage.getItem("userSem"))[d-1],o=s.substring(10),u=parseInt(s.substring(0,4)),l=parseInt(s.substring(5,9)),r="",a=0;1==o?(a=2,r=u+"/"+l+"-"+a):(a=1,r=l+"/"+(l+1)+"-"+a),t.push(r),sessionStorage.setItem("userSem",JSON.stringify(t)),e.unlockSem[d]=!0,e.tempStorage=[];var a=(d+1)%2;0==a&&(a=2);for(var i=0;5>i;i++)e.tempStorage.push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:"-",selectedModGrade:"-",ModuleGrade:["-"],AcadYear:r.substring(0,9),Semester:a});e.modsPerSem.push(e.tempStorage)},e.addModule=function(){e.modsPerSem[0].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[0].substring(0,9),Semester:1})},e.addModule1=function(){e.modsPerSem[1].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[1].substring(0,9),Semester:1})},e.addModule2=function(){e.modsPerSem[2].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[2].substring(0,9),Semester:1})},e.addModule3=function(){e.modsPerSem[3].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[3].substring(0,9),Semester:1})},e.addModule4=function(){e.modsPerSem[4].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[4].substring(0,9),Semester:1})},e.addModule5=function(){e.modsPerSem[5].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[5].substring(0,9),Semester:1})},e.addModule6=function(){e.modsPerSem[6].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[6].substring(0,9),Semester:1})},e.addModule7=function(){e.modsPerSem[7].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[7].substring(0,9),Semester:1})},e.addModule8=function(){e.modsPerSem[8].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[8].substring(0,9),Semester:1})},e.addModule9=function(){e.modsPerSem[9].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[9].substring(0,9),Semester:1})},e.addModule10=function(){e.modsPerSem[10].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[10].substring(0,9),Semester:1})},e.addModule11=function(){e.modsPerSem[11].push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:JSON.parse(sessionStorage.getItem("userSem"))[11].substring(0,9),Semester:1})},o.onload=function(){e.capResult="0.00",n=0,S=0,sessionStorage.setItem("totalGradedPoint",0),sessionStorage.setItem("totalGradedMC",0)},e.$on("$stateChangeSuccess",function(){e.capResult="0.00",isNaN(parseInt(sessionStorage.getItem("totalGradedMC")))||isNaN(parseInt(sessionStorage.getItem("totalGradedPoint")))?(n=0,S=0):(n=parseInt(sessionStorage.getItem("totalGradedMC")),S=parseInt(sessionStorage.getItem("totalGradedPoint")),e.capResult=(S/n).toFixed(2),isNaN(e.capResult)&&(e.capResult="0.00"))}),e.searchMod=function(t,d){t.ModuleCode=t.ModuleCode.toUpperCase();var s=JSON.parse(sessionStorage.getItem("preclusionList"));a(t.ModuleCode.toUpperCase(),t.Semester,t.AcadYear).then(function(o){if(""!==o.data){var u=!1;angular.forEach(s,function(d,s){return t.ModuleCode===e.preclusionList[s]?(u=!0,""):void 0}),0==u?(l(t.ModuleCode.toUpperCase(),t.Semester,t.AcadYear),sessionStorage.setItem("preclusionList",JSON.stringify(e.preclusionList)),t.ModuleTitle=o.data.ModuleTitle,t.ModuleCredit=o.data.ModuleCredit,t.ModuleSuStatus=["No","Yes","Exempted","Waived"],t.ModuleGrade=["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],t.modFound=!0,t.selectedModGrade="-",t.selectedModSuStatus="No"):(t.ModuleTitle="Modules Taken/Precluded",t.ModuleCredit="-",t.ModuleSuStatus=["-"],t.ModuleGrade=["-"],t.modFound=!1,t.selectedModGrade="-",t.selectedModSuStatus="-"),console.log(o)}else t.ModuleSuStatus=["-"],t.ModuleGrade=["-"],t.selectedModGrade="-",t.selectedModSuStatus="-",t.ModuleCode.length>=7?t.ModuleTitle="Module Not Available":(""!==d.ModuleCredit&&null!==d.selectedModGrade&&"-"!==d.selectedModGrade&&(d.modFound===!0&&"No"===d.selectedModSuStatus&&void 0!==d.selectedModGrade&&(console.log(d.selectedModGrade),console.log("do calculation"),n-=parseInt(d.ModuleCredit),S-=i(d.selectedModGrade)*d.ModuleCredit,t.modFound=!1,e.capResult=(S/n).toFixed(2),isNaN(e.capResult)&&(e.capResult="0.00"),(isNaN(n)||isNaN(S))&&(n=0,S=0)),r(d.ModuleCode,d.Semester,d.AcadYear),u=!1),t.ModuleTitle=""),t.ModuleCredit="",t.selectedModGrade="-",t.selectedModSuStatus="-"})},e.changeValue=function(t,d){"Exempted"===t.selectedModSuStatus||"Waived"===t.selectedModSuStatus||"Yes"===t.selectedModSuStatus?(t.selectedModGrade="-",t.ModuleGrade=["-"]):t.ModuleGrade=["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],sessionStorage.setItem(t.ModuleCode,JSON.stringify({ModuleTitle:t.ModuleTitle,ModuleCredit:t.ModuleCredit,ModuleStatus:t.ModuleStatus,ModuleSuStatus:t.ModuleSuStatus,selectedModSuStatus:t.selectedModSuStatus,selectedModGrade:t.selectedModGrade,ModuleGrade:t.selectedModGrade,AcadYear:t.AcadYear,Semester:t.Semester})),e.$applyAsync(function(){"No"===d.selectedModSuStatus&&null!==d.selectedModGrade&&"-"!==d.selectedModGrade&&void 0!==d.selectedModGrade&&(n-=parseInt(d.ModuleCredit),S-=i(d.selectedModGrade)*d.ModuleCredit),"No"===t.selectedModSuStatus&&null!==t.selectedModGrade&&"-"!==t.selectedModGrade&&0!==i(t.selectedModGrade)&&(n+=parseInt(t.ModuleCredit),S+=i(t.selectedModGrade)*t.ModuleCredit),e.capResult=(S/n).toFixed(2),isNaN(e.capResult)&&(e.capResult="0.00"),(isNaN(n)||isNaN(S))&&(n=0,S=0),console.log("Total graded Mc : "+n),console.log("Total Graded point : "+S),sessionStorage.setItem("totalGradedMC",n),sessionStorage.setItem("totalGradedPoint",S)})}}var token;null==sessionStorage.getItem("token")?(token=getUrlVars().token,sessionStorage.setItem("isValidToken",!1)):(token=sessionStorage.getItem("token"),sessionStorage.setItem("isValidToken",!0));var userName,studentId;angular.module("NUSAP").controller("CapCalCtrl",["$scope","$cookieStore","$http","$location","$window","$timeout",CapCalCtrl]);
function getUrlVars(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,o,s){e[o]=s});return e}function MasterCtrl(e,t,o,s,a,r,d,i){function n(){return o({method:"GET",url:"index.php?id=majorReq&maj=cs"})}function l(){return o({method:"GET",url:"index.php?id=profile&token="+token})}function u(e){return o({method:"GET",url:"index.php?id=modsTaken&token="+token+"&studentID="+e})}function c(e,t,s){return o({method:"GET",url:"index.php?id=checkMod&modCode="+e+"&sem="+t+"&acadYear="+s})}function g(){return o({method:"GET",url:"index.php?id=modSearch"})}function M(){var e=[];n().then(function(t){var o=JSON.parse(sessionStorage.getItem("matricYear"));o=parseInt(o),2015>o&&(o=2015);var s="matric"+o,a=t.data[s];e=a[0].totalModules[0].mods;var r=a[0].requiredMc;sessionStorage.setItem("coreRequiredMc",r),sessionStorage.setItem("coreModules",JSON.stringify(e))})}function S(){var e=[];n().then(function(t){var o=JSON.parse(sessionStorage.getItem("matricYear"));o=parseInt(o),2015>o&&(o=2015);for(var s="matric"+o,a=t.data[s],r=a[1].totalModules.length,d=0;r>d;d++)e.push(a[1].totalModules[d].mods);var i=a[1].requiredMc;sessionStorage.setItem("projectRequiredMc",i),sessionStorage.setItem("project8thMcModules",JSON.stringify(e))})}function m(){var e=[];n().then(function(t){var o=JSON.parse(sessionStorage.getItem("matricYear"));o=parseInt(o),2015>o&&(o=2015);for(var s="matric"+o,a=t.data[s],r=a[2].totalModules.length,d=0;r>d;d++)e.push(a[2].totalModules[d].mods);var i=a[2].requiredMc;sessionStorage.setItem("internshipRequiredMc",i),sessionStorage.setItem("internshipModules",JSON.stringify(e))})}function f(){var e=[];n().then(function(t){var o=JSON.parse(sessionStorage.getItem("matricYear"));o=parseInt(o),2015>o&&(o=2015);var s="matric"+o,a=t.data[s];e=a[3].totalModules[0].mods;var r=a[3].requiredMc;sessionStorage.setItem("mathSciRequiredMc",r),sessionStorage.setItem("mathSciModules",JSON.stringify(e))})}function p(){var e=[];n().then(function(t){var o=JSON.parse(sessionStorage.getItem("matricYear"));o=parseInt(o),2015>o&&(o=2015);var s="matric"+o,a=t.data[s];e=a[4].totalModules[0].mods;var r=a[4].requiredMc;sessionStorage.setItem("breathDepthRequiredMc",r),sessionStorage.setItem("breathDepthModules",JSON.stringify(e))})}function h(){var e=[];n().then(function(t){var o=JSON.parse(sessionStorage.getItem("matricYear"));o=parseInt(o),2015>o&&(o=2015);var s="matric"+o,a=t.data[s];e=a[5].totalModules[0].mods;var r=a[5].requiredMc;sessionStorage.setItem("ULRRequiredMc",r),sessionStorage.setItem("ULRModules",JSON.stringify(e))})}function C(t,o,s){c(t,o,s).then(function(o){if(""!==o.data){var s=[];e.preclusionList.push(t),void 0!==o.data.Preclusion&&(s=o.data.Preclusion.split(","),angular.forEach(s,function(t,o){if(-1==s[o].trim().indexOf("or")&&-1==s[o].trim().indexOf("OR")&&-1==s[o].trim().indexOf("and")&&-1==s[o].trim().indexOf("/"))s[o].trim().length<9&&e.preclusionList.push(s[o].trim());else if(-1!=s[o].trim().indexOf(" or ")){var a=[];a=s[o].trim().split(" or "),angular.forEach(a,function(t,o){if(-1==a[o].indexOf(" OR "))a[o].trim().length<9&&e.preclusionList.push(a[o].trim());else{var s=[];s=a[o].trim().split(" OR "),angular.forEach(s,function(t,o){s[o].trim().length<9&&e.preclusionList.push(s[o].trim())})}})}else if(-1!=s[o].trim().indexOf(" OR ")){var a=[];a=s[o].trim().split(" OR "),angular.forEach(a,function(t,o){a[o].trim().length<9&&e.preclusionList.push(a[o].trim())})}else if(-1!=s[o].trim().indexOf(" and ")){var a=[];a=s[o].trim().split(" and "),angular.forEach(a,function(t,o){a[o].trim().length<9&&e.preclusionList.push(a[o].trim())})}else if(-1!=s[o].trim().indexOf("/")){var a=[];a=s[o].trim().split("/"),angular.forEach(a,function(t,o){a[o].trim().length<9&&e.preclusionList.push(a[o].trim())})}}))}sessionStorage.setItem("preclusionList",JSON.stringify(e.preclusionList));var a=JSON.parse(sessionStorage.getItem("UEModules")),r=parseInt(sessionStorage.getItem("UERequiredMc")),d=JSON.parse(sessionStorage.getItem("coreModules")),i=parseInt(sessionStorage.getItem("coreRequiredMc"));angular.forEach(e.preclusionList,function(e,t){-1!=d.indexOf(e)&&(d.splice(d.indexOf(e),1),sessionStorage.setItem("coreModules",JSON.stringify(d)),i-=4,0>=i&&(i=0),sessionStorage.setItem("coreRequiredMc",i),angular.forEach(a,function(t,o){t.ModuleCode===e&&(a.splice(a.indexOf(t),1),sessionStorage.setItem("UEModules",JSON.stringify(a)))}))}),angular.forEach(a,function(e,t){"CS1101S"===e.ModuleCode&&(a.splice(a.indexOf(e),1),sessionStorage.setItem("UEModules",JSON.stringify(a))),"CS1010R"===e.ModuleCode&&(a.splice(a.indexOf(e),1),sessionStorage.setItem("UEModules",JSON.stringify(a))),"CS2103"===e.ModuleCode&&(a.splice(a.indexOf(e),1),sessionStorage.setItem("UEModules",JSON.stringify(a))),"IS2101"===e.ModuleCode&&(a.splice(a.indexOf(e),1),sessionStorage.setItem("UEModules",JSON.stringify(a))),"ES1102"===e.ModuleCode&&(a.splice(a.indexOf(e),1),sessionStorage.setItem("UEModules",JSON.stringify(a))),"ES1103"===e.ModuleCode&&(a.splice(a.indexOf(e),1),sessionStorage.setItem("UEModules",JSON.stringify(a))),"CFG1010"===e.ModuleCode&&(a.splice(a.indexOf(e),1),sessionStorage.setItem("UEModules",JSON.stringify(a)))});var n=JSON.parse(sessionStorage.getItem("project8thMcModules")),l=parseInt(sessionStorage.getItem("projectRequiredMc"));angular.forEach(e.preclusionList,function(e,t){angular.forEach(n,function(t,o){-1!=t.indexOf(e)&&(t.splice(t.indexOf(e),1),sessionStorage.setItem("project8thMcModules",JSON.stringify(n)),l-=4,0>=l&&(l=0),sessionStorage.setItem("projectRequiredMc",l),angular.forEach(a,function(t,o){t.ModuleCode===e&&(a.splice(a.indexOf(t),1),sessionStorage.setItem("UEModules",JSON.stringify(a)))}))})});var u=JSON.parse(sessionStorage.getItem("internshipModules")),c=parseInt(sessionStorage.getItem("internshipRequiredMc"));angular.forEach(e.preclusionList,function(e,t){-1!=u[0].indexOf(e)?(u[0].splice(u[0].indexOf(e),1),sessionStorage.setItem("internshipModules",JSON.stringify(u)),c-=12,angular.forEach(a,function(t,o){t.ModuleCode===e&&(a.splice(a.indexOf(t),1),sessionStorage.setItem("UEModules",JSON.stringify(a)))})):-1!=u[1].indexOf(e)&&(u[1].splice(u[1].indexOf(e),1),sessionStorage.setItem("internshipModules",JSON.stringify(u)),c-=6,angular.forEach(a,function(t,o){t.ModuleCode===e&&(a.splice(a.indexOf(t),1),sessionStorage.setItem("UEModules",JSON.stringify(a)))})),sessionStorage.setItem("internshipRequiredMc",c)});var g=JSON.parse(sessionStorage.getItem("mathSciModules")),M=parseInt(sessionStorage.getItem("mathSciRequiredMc")),S=JSON.parse(sessionStorage.getItem("modsTaken"));angular.forEach(e.preclusionList,function(e,t){-1!=g.indexOf(e)&&(g.splice(g.indexOf(e),1),sessionStorage.setItem("mathSciModules",JSON.stringify(g)),angular.forEach(S,function(t,o){t.ModuleCode===e&&(M-=4)}),angular.forEach(a,function(t,o){t.ModuleCode===e&&(a.splice(a.indexOf(t),1),sessionStorage.setItem("UEModules",JSON.stringify(a)))}),sessionStorage.setItem("mathSciRequiredMc",M))}),-1==g.indexOf("MA1521")&&-1!=g.indexOf("MA1301")&&(g.splice(g.indexOf("MA1301"),1),sessionStorage.setItem("mathSciModules",JSON.stringify(g)),M-=4,sessionStorage.setItem("mathSciRequiredMc",M));var m=JSON.parse(sessionStorage.getItem("breathDepthModules")),f=parseInt(sessionStorage.getItem("breathDepthRequiredMc"));angular.forEach(e.preclusionList,function(e,t){-1!=m.indexOf(e)&&(0>=f&&-1!=a.indexOf(e)&&(a.splice(a.indexOf(e),1),sessionStorage.setItem("UEModules",JSON.stringify(a)),r-=4,sessionStorage.setItem("UERequiredMc",r)),m.splice(m.indexOf(e),1),sessionStorage.setItem("breathDepthModules",JSON.stringify(m)),f-=4,sessionStorage.setItem("breathDepthRequiredMc",f),angular.forEach(a,function(t,o){t.ModuleCode===e&&(a.splice(a.indexOf(t),1),sessionStorage.setItem("UEModules",JSON.stringify(a)))}))});var p=JSON.parse(sessionStorage.getItem("ULRModules")),h=parseInt(sessionStorage.getItem("ULRRequiredMc")),C=JSON.parse(sessionStorage.getItem("modsTaken"));angular.forEach(e.preclusionList,function(e,t){-1!=p.indexOf(e)&&(p.splice(p.indexOf(e),1),sessionStorage.setItem("ULRModules",JSON.stringify(p)),angular.forEach(C,function(t,o){t.ModuleCode===e&&(h-=4)}),sessionStorage.setItem("ULRRequiredMc",h),angular.forEach(a,function(t,o){t.ModuleCode===e&&(a.splice(a.indexOf(t),1),sessionStorage.setItem("UEModules",JSON.stringify(a)))}))}),e.$applyAsync(function(){e.currentULR=((20-h)/20*100).toFixed(0),e.currentCore=((120-(f+i+l+c+M))/120*100).toFixed(0),a.length>=0?e.currentUE=(a.length/5*100).toFixed(0):e.currentUE=0,e.overallProgress=(parseInt(e.currentULR)+parseInt(e.currentCore)+parseInt(e.currentUE))/3,e.overallProgress=e.overallProgress.toFixed(0)+"%",e.currentULR=e.currentULR+"%",e.currentCore=e.currentCore+"%",e.currentUE>100?e.currentUE="100%":e.currentUE=e.currentUE+"%"})})}a.onload=function(){e.capResult="0.00",totalGradedMC=0,totalGradePoint=0,sessionStorage.setItem("totalGradedPoint",0),sessionStorage.setItem("totalGradedMC",0)},e.$on("$stateChangeSuccess",function(){e.dashboardLoading=!1,e.searchLoading=!0,i(function(){e.dashboardLoading=!0},6e3)});var I=992;e.username="",e.showProfile=function(){e.userProfile=!e.userProfile,e.toDisplayMessage=!0},e.preclusionList=[],e.modList=[],e.notPrecluded=!0,e.prerequisiteNotFulfill=!0,e.filterULR=function(){e.modList=[],e.$applyAsync(function(){var t=new Date,o=t.getFullYear(),s=parseInt(t.getMonth())+1,a=1;7>s&&(o=parseInt(o)-1,a=2);var r=o+"/"+(parseInt(o)+1);e.modList.length=0,e.searchLoading=!1,i(function(){e.searchLoading=!0},3e3);var d=JSON.parse(sessionStorage.getItem("ULRModules")),n=JSON.parse(sessionStorage.getItem("preclusionList"));angular.forEach(d,function(t,o){c(t,a,r).then(function(t){""!=t.data&&-1==n.indexOf(t.data.ModuleCode)&&e.modList.push({ModuleCode:t.data.ModuleCode,ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleSuStatus:["No","Yes","Exempted","Waived"],ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],modFound:!0,selectedModGrade:"-",selectedModSuStatus:"No",colorCode:"#e6d8ff"})})})})},e.filterCore=function(){e.modList=[],e.$applyAsync(function(){e.searchLoading=!1,i(function(){e.searchLoading=!0},3e3);var t=new Date,o=t.getFullYear(),s=parseInt(t.getMonth())+1,a=1;7>s&&(o=parseInt(o)-1,a=2);var r=o+"/"+(parseInt(o)+1);e.modList.length=0;var d=JSON.parse(sessionStorage.getItem("preclusionList")),n=JSON.parse(sessionStorage.getItem("coreModules")),l=JSON.parse(sessionStorage.getItem("breathDepthModules")),u=parseInt(sessionStorage.getItem("internshipRequiredMc"));if(12>u)var g=JSON.parse(sessionStorage.getItem("internshipModules"))[1];else{var g=JSON.parse(sessionStorage.getItem("internshipModules"))[1];g.unshift(JSON.parse(sessionStorage.getItem("internshipModules"))[0][0])}var M=JSON.parse(sessionStorage.getItem("mathSciModules")),S=JSON.parse(sessionStorage.getItem("project8thMcModules"));angular.forEach(n,function(t,o){c(t,a,r).then(function(t){""!=t.data&&-1==d.indexOf(t.data.ModuleCode)&&e.modList.push({ModuleCode:t.data.ModuleCode,ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleSuStatus:["No","Yes","Exempted","Waived"],ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],modFound:!0,selectedModGrade:"-",selectedModSuStatus:"No",colorCode:"#c5fbff"})})}),angular.forEach(M,function(t,o){c(t,a,r).then(function(t){""!=t.data&&-1==d.indexOf(t.data.ModuleCode)&&e.modList.push({ModuleCode:t.data.ModuleCode,ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleSuStatus:["No","Yes","Exempted","Waived"],ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],modFound:!0,selectedModGrade:"-",selectedModSuStatus:"No",colorCode:"#c5ffc3"})})}),angular.forEach(g,function(t,o){c(t,a,r).then(function(t){""!=t.data&&-1==d.indexOf(t.data.ModuleCode)&&e.modList.push({ModuleCode:t.data.ModuleCode,ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleSuStatus:["No","Yes","Exempted","Waived"],ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],modFound:!0,selectedModGrade:"-",selectedModSuStatus:"No",colorCode:"#c5fbff"})})}),angular.forEach(l,function(t,o){c(t,a,r).then(function(t){""!=t.data&&-1==d.indexOf(t.data.ModuleCode)&&e.modList.push({ModuleCode:t.data.ModuleCode,ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleSuStatus:["No","Yes","Exempted","Waived"],ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],modFound:!0,selectedModGrade:"-",selectedModSuStatus:"No",colorCode:"#c5fbff"})})}),angular.forEach(S,function(t,o){for(var s=0;s<t.length;s++)c(t[s],a,r).then(function(t){""!=t.data&&-1==d.indexOf(t.data.ModuleCode)&&e.modList.push({ModuleCode:t.data.ModuleCode,ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleSuStatus:["No","Yes","Exempted","Waived"],ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],modFound:!0,selectedModGrade:"-",selectedModSuStatus:"No",colorCode:"#c5fbff"})})}),e.$applyAsync(function(){console.log(e.modList),0==e.modList.length?(e.displayMessage="No other modules left!",e.toDisplayMessage=!1):(e.displayMessage="",e.toDisplayMessage=!0)})})},g().then(function(t){sessionStorage.setItem("modsList",JSON.stringify(t.data));var o=JSON.parse(sessionStorage.getItem("modsList"));e.tempModList=o}),e.isUpdated=!1,e.updateModList=function(t){var o=sessionStorage.getItem("oldText");if(null==o&&(o=""),e.searchLoading=!1,i(function(){e.searchLoading=!0},2e3),t=t.toUpperCase(),console.log("current Text : "+t),t.length<1)e.modList=[],e.isUpdated=!0;else if(o.length<t.length){var s=new Date,a=s.getFullYear(),r=parseInt(s.getMonth())+1,d=1;7>r&&(a=parseInt(a)-1,d=2);var n=a+"/"+(parseInt(a)+1);e.modList=[];var l=JSON.parse(sessionStorage.getItem("preclusionList"));angular.forEach(e.tempModList,function(o,s){if(e.tempModList[s].ModuleCode.includes(t)&&-1==l.indexOf(e.tempModList[s].ModuleCode))if(-1!=l.indexOf("CS1010")&&"CS1010J"===e.tempModList[s].ModuleCode);else{var a="";if(e.tempModList[s].ModuleCode.startsWith("CS")||e.tempModList[s].ModuleCode.startsWith("CP"))var a="#c5fbff";else if(e.tempModList[s].ModuleCode.startsWith("MA")||e.tempModList[s].ModuleCode.startsWith("LSM")||e.tempModList[s].ModuleCode.startsWith("PC")||e.tempModList[s].ModuleCode.startsWith("CM")||e.tempModList[s].ModuleCode.startsWith("ST"))var a="#c5ffc3";else if(e.tempModList[s].ModuleCode.startsWith("IS"))var a="#fbbaca";else if(e.tempModList[s].ModuleCode.startsWith("GE"))var a="#e6d8ff";else var a="#ffedc4";e.modList.push({ModuleCode:e.tempModList[s].ModuleCode,ModuleTitle:e.tempModList[s].ModuleTitle,Semesters:e.tempModList[s].Semesters,ModuleCredit:4,ModuleStatus:"Normal",ModuleSuStatus:["No","Yes","Exempted","Waived"],selectedModSuStatus:"No",selectedModGrade:null,ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],AcadYear:n,Semester:d,type:"CORE",colorCode:a})}})}else{console.log("Testing ...");var s=new Date,a=s.getFullYear(),r=parseInt(s.getMonth())+1,d=1;7>r&&(a=parseInt(a)-1,d=2);var n=a+"/"+(parseInt(a)+1);if(0==e.isUpdated){e.modList=[];for(var u=0;u<e.tempModList.length;u++)e.tempModList[u].ModuleCode.includes(t)&&e.modList.push({ModuleCode:e.tempModList[u].ModuleCode,ModuleTitle:e.tempModList[u].ModuleTitle,Semesters:e.tempModList[u].Semesters})}else{var c=e.modList;e.modList=[];for(var u=0;u<c.length;u++)c[u].ModuleCode.includes(t)&&e.modList.push({ModuleCode:c[u].ModuleCode,ModuleTitle:c[u].ModuleTitle,Semesters:c[u].Semesters})}sessionStorage.setItem("oldText",t)}e.$applyAsync(function(){0==e.modList.length&&t.length<1?e.$applyAsync(function(){e.displayMessage="Please search for a module!",e.toDisplayMessage=!1}):0==e.modList.length?e.$applyAsync(function(){e.displayMessage="Module is taken/precluded!",e.toDisplayMessage=!1}):e.$applyAsync(function(){e.displayMessage="",e.toDisplayMessage=!0})})},e.getProfile=function(){function t(e){e=parseInt(e);for(var t=parseInt(JSON.parse(sessionStorage.getItem("modsTaken"))[0].AcadYear.substring(0,4)),o=[],s=new Date,a=(s.getFullYear(),parseInt(s.getMonth())+1),r=e;t>=r;r++){var d=r+1;if(t>r){var i=r+"/"+d+"-1";o.push(i),i=r+"/"+d+"-2",o.push(i)}else if(7>a){var i=r+"/"+d+"-1";o.push(i),i=r+"/"+d+"-2",o.push(i)}else{var i=r+"/"+d+"-1";o.push(i)}}var n=parseInt(JSON.parse(sessionStorage.getItem("modsTaken"))[0].Semester);if(2==n){var i=(o[o.length-1],JSON.parse(sessionStorage.getItem("modsTaken"))[0].AcadYear.substring(0,9));i+="-2",o.push(i)}return o}l().then(function(o){console.log(o.data),e.username=o.data.Results[0].Name,M(),S(),m(),f(),p(),h(),sessionStorage.setItem("userName",e.username),sessionStorage.setItem("netid",o.data.Results[0].UserID),sessionStorage.setItem("firstMajor",o.data.Results[0].FirstMajor),sessionStorage.setItem("secondMajor",o.data.Results[0].SecondMajor),sessionStorage.setItem("matricYear",o.data.Results[0].MatriculationYear),e.plannerSize=[],e.unlockSem=[];for(var s=4,a=o.data.Results[0].MatriculationYear,r=0;s>r;r++)e.plannerSize.push({candidatureYear:parseInt(a)+r+"/"+(parseInt(a)+r+1)});e.addYear=function(){if(s+=1,!(s>6)){var t={candidatureYear:parseInt(a)+s-1+"/"+(parseInt(a)+s)};e.plannerSize.push(t)}},u(o.data.Results[0].UserID).then(function(o){e.modsCount=o.data.Results.length,sessionStorage.setItem("modsTaken",JSON.stringify(o.data.Results)),sessionStorage.setItem("UEModules",JSON.stringify(o.data.Results)),sessionStorage.setItem("UERequiredMc",20),e.specialMods=[],e.modsPerSem=[];var s=JSON.parse(sessionStorage.getItem("modsTaken"));JSON.parse(sessionStorage.getItem("modsTaken")).length;sessionStorage.setItem("userSem",JSON.stringify(t(JSON.parse(sessionStorage.getItem("matricYear"))))),console.log("test result : "+t(JSON.parse(sessionStorage.getItem("matricYear"))));var a=JSON.parse(sessionStorage.getItem("userSem"));angular.forEach(a,function(t,o){e.takenMods=[];var r=[];e.unlockSem.push(!1),angular.forEach(s,function(t,d){s[d].Semester==a[o].substring(10,11)&&s[d].AcadYear==a[o].substring(0,9)&&c(s[d].ModuleCode,s[d].Semester,s[d].AcadYear).then(function(t){var o=parseInt(sessionStorage.getItem("totalCreditTaken"));if(e.$applyAsync(function(){}),""===t.data)o+=4,sessionStorage.setItem("totalCreditTaken",o),r.unshift({ModuleCode:s[d].ModuleCode,ModuleTitle:s[d].ModuleTitle,ModuleCredit:4,ModuleStatus:"Exempted",ModuleSuStatus:["Exempted"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:s[d].AcadYear,Semester:s[d].Semester,type:"UE",colorCode:"#ffedc4"}),e.takenMods.push({ModuleCode:s[d].ModuleCode,ModuleTitle:s[d].ModuleTitle,ModuleCredit:4,ModuleStatus:"Exempted",ModuleSuStatus:["Exempted"],selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:["-"],AcadYear:s[d].AcadYear,Semester:s[d].Semester,type:"UE",colorCode:"#ffedc4"}),r[0].selectedModGrade=r[0].ModuleGrade[0],r[0].selectedModSuStatus=r[0].ModuleSuStatus[0],sessionStorage.setItem(s[d].ModuleCode,JSON.stringify({ModuleTitle:s[d].ModuleTitle,ModuleCredit:4,ModuleStatus:"Exempted",ModuleSuStatus:"Yes",selectedModSuStatus:null,selectedModGrade:null,ModuleGrade:"-",AcadYear:s[d].AcadYear,Semester:s[d].Semester,type:"UE",colorCode:"#ffedc4"}));else{if(o+=parseInt(t.data.ModuleCredit),sessionStorage.setItem("totalCreditTaken",o),C(t.data.ModuleCode,s[d].Semester,s[d].AcadYear),-1!=t.data.ModuleCode.indexOf("CS")||-1!=t.data.ModuleCode.indexOf("CP"))var a="#c5fbff";else if(-1!=t.data.ModuleCode.indexOf("MA")||-1!=t.data.ModuleCode.indexOf("LSM")||-1!=t.data.ModuleCode.indexOf("PC")||-1!=t.data.ModuleCode.indexOf("CM")||-1!=t.data.ModuleCode.indexOf("ST"))var a="#c5ffc3";else if(-1!=t.data.ModuleCode.indexOf("IS"))var a="#fbbaca";else if(-1!=t.data.ModuleCode.indexOf("GE"))var a="#e6d8ff";else var a="#ffedc4";r.push({ModuleCode:t.data.ModuleCode,ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleStatus:"Normal",ModuleSuStatus:["No","Yes","Exempted","Waived"],selectedModSuStatus:"No",selectedModGrade:null,ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],AcadYear:s[d].AcadYear,Semester:s[d].Semester,type:"CORE",colorCode:a}),e.takenMods.push({ModuleCode:t.data.ModuleCode,ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleStatus:"Normal",ModuleSuStatus:["No","Yes","Exempted","Waived"],selectedModSuStatus:"No",selectedModGrade:null,ModuleGrade:["A+","A","A-","B+","B","B-","C+","C","D+","D","F"],AcadYear:s[d].AcadYear,Semester:s[d].Semester,type:"CORE",colorCode:a}),sessionStorage.setItem(t.data.ModuleCode,JSON.stringify({ModuleTitle:t.data.ModuleTitle,ModuleCredit:t.data.ModuleCredit,ModuleStatus:"Normal",ModuleSuStatus:"No",selectedModSuStatus:"No",selectedModGrade:null,ModuleGrade:"-",AcadYear:s[d].AcadYear,Semester:s[d].Semester,type:"CORE",colorCode:a}))}})}),e.modsPerSem.push(r)}),e.addSemester=function(){var t=[],o=JSON.parse(sessionStorage.getItem("userSem")).length;t=JSON.parse(sessionStorage.getItem("userSem"));var s=JSON.parse(sessionStorage.getItem("userSem"))[o-1],a=s.substring(10),r=parseInt(s.substring(0,4)),d=parseInt(s.substring(5,9)),i="",n=0;1==a?(n=2,i=r+"/"+d+"-"+n):(n=1,i=d+"/"+(d+1)+"-"+n),t.push(i),sessionStorage.setItem("userSem",JSON.stringify(t)),e.unlockSem[o]=!0,e.tempStorage=[];var n=(o+1)%2;0==n&&(n=2);for(var l=0;5>l;l++)e.tempStorage.push({ModuleCode:"",ModuleTitle:"",ModuleCredit:"",ModuleStatus:"Normal",ModuleSuStatus:["-"],selectedModSuStatus:"-",selectedModGrade:"-",ModuleGrade:["-"],AcadYear:i.substring(0,9),Semester:n,type:null,colorCode:"#ffedc4"});e.modsPerSem.push(e.tempStorage)},console.log(a.length);for(var r=a.length;8>r;r++)e.addSemester();console.log(a.length),e.removeMod=function(t){angular.forEach(e.modsPerSem,function(t,o){return console.log("--"),""==e.modsPerSem[o].ModuleTitle?(console.log("-"),void e.modsPerSem[o].splice(0,1)):void 0}),e.modList.splice(t,1)},e.findType=function(e){document.getElementById("type")}},function(e){console.log("error no mods found")})},function(t){console.log("Invalid User"),e.username="Invalid User"})},e.logout=function(){sessionStorage.clear(),e.$applyAsync(function(){e.showMenu=!1}),window.location="http://localhost:8888/dist"},e.checkToken=function(){var t={method:"GET",url:"index.php?id=checkToken&token="+token};o(t).then(function(t){if($result=t.data.Success,0==$result)s.path("/login");else{var o=$result;e.$applyAsync(function(){e.showMenu=!0}),sessionStorage.setItem("isValidToken",o),sessionStorage.setItem("token",token)}},function(e){console.log("Error")})},e.getWidth=function(){return window.innerWidth},$(".popup").mouseover(function(){$(this).children(".moduleDetails").show()}).mouseout(function(){$(this).children(".moduleDetails").hide()}),$(document).ready(function(){var e;new Clipboard(".invite-link"),$.ajax({url:"https://www.googleapis.com/urlshortener/v1/url?key=AIzaSyBsoXP_gCh3umRVKqP5MOHfEHs1fxK84g0",type:"POST",data:JSON.stringify({longUrl:window.location.href}),contentType:"application/json",dataType:"json",success:function(t){e=t.id,$(".invite-link").attr("data-clipboard-text",e)}}),$(".invite-link").click(function(){var t=$("#invite-link");t.attr("value",e)})}),e.$watch(e.getWidth,function(o,s){o>=I?angular.isDefined(t.get("toggle"))?e.toggle=!!t.get("toggle"):e.toggle=!0:e.toggle=!1}),e.toggleSidebar=function(){e.toggle=!e.toggle,t.put("toggle",e.toggle)},window.onresize=function(){e.$apply()}}var token;null==sessionStorage.getItem("token")?(token=getUrlVars().token,sessionStorage.setItem("isValidToken",!1)):(token=sessionStorage.getItem("token"),sessionStorage.setItem("isValidToken",!0),history.replaceState({},null,"index.html"));var userName,studentId;sessionStorage.setItem("totalCreditTaken",0),angular.module("NUSAP").controller("MasterCtrl",["$scope","$cookieStore","$http","$location","$window","$q","$log","$timeout",MasterCtrl]);

angular.module("NUSAP").directive("dndDraggable",["$parse","$timeout","dndDropEffectWorkaround","dndDragTypeWorkaround",function(e,n,r,t){return function(a,d,o){d.attr("draggable","true"),o.dndDisableIf&&a.$watch(o.dndDisableIf,function(e){d.attr("draggable",!e)}),d.on("dragstart",function(i){return i=i.originalEvent||i,"false"==d.attr("draggable")?!0:(i.dataTransfer.setData("Text",angular.toJson(a.$eval(o.dndDraggable))),i.dataTransfer.effectAllowed=o.dndEffectAllowed||"move",d.addClass("dndDragging"),n(function(){d.addClass("dndDraggingSource")},0),r.dropEffect="none",t.isDragging=!0,t.dragType=o.dndType?a.$eval(o.dndType):void 0,i._dndHandle&&i.dataTransfer.setDragImage&&i.dataTransfer.setDragImage(d[0],0,0),e(o.dndDragstart)(a,{event:i}),void i.stopPropagation())}),d.on("dragend",function(i){i=i.originalEvent||i;var f=r.dropEffect;a.$apply(function(){switch(f){case"move":e(o.dndMoved)(a,{event:i});break;case"copy":e(o.dndCopied)(a,{event:i});break;case"none":e(o.dndCanceled)(a,{event:i})}e(o.dndDragend)(a,{event:i,dropEffect:f})}),d.removeClass("dndDragging"),n(function(){d.removeClass("dndDraggingSource")},0),t.isDragging=!1,i.stopPropagation()}),d.on("click",function(n){o.dndSelected&&(n=n.originalEvent||n,a.$apply(function(){e(o.dndSelected)(a,{event:n})}),n.stopPropagation())}),d.on("selectstart",function(){this.dragDrop&&this.dragDrop()})}}]).directive("dndList",["$parse","$timeout","dndDropEffectWorkaround","dndDragTypeWorkaround",function(e,n,r,t){return function(a,d,o){function i(e,n,r){var t=E?e.offsetX||e.layerX:e.offsetY||e.layerY,a=E?n.offsetWidth:n.offsetHeight,d=E?n.offsetLeft:n.offsetTop;return d=r?d:0,d+a/2>t}function f(){var e;return angular.forEach(d.children(),function(n){var r=angular.element(n);r.hasClass("dndPlaceholder")&&(e=r)}),e||angular.element("<li class='dndPlaceholder'></li>")}function l(){return Array.prototype.indexOf.call(D.children,v)}function g(e){if(!t.isDragging&&!y)return!1;if(!c(e.dataTransfer.types))return!1;if(o.dndAllowedTypes&&t.isDragging){var n=a.$eval(o.dndAllowedTypes);if(angular.isArray(n)&&-1===n.indexOf(t.dragType))return!1}return!o.dndDisableIf||!a.$eval(o.dndDisableIf)}function s(){return p.remove(),d.removeClass("dndDragover"),!0}function u(n,r,d,o){return e(n)(a,{event:r,index:d,item:o||void 0,external:!t.isDragging,type:t.isDragging?t.dragType:void 0})}function c(e){if(!e)return!0;for(var n=0;n<e.length;n++)if("Text"===e[n]||"text/plain"===e[n])return!0;return!1}var p=f(),v=p[0],D=d[0];p.remove();var E=o.dndHorizontalList&&a.$eval(o.dndHorizontalList),y=o.dndExternalSources&&a.$eval(o.dndExternalSources);d.on("dragenter",function(e){return e=e.originalEvent||e,g(e)?void e.preventDefault():!0}),d.on("dragover",function(e){if(e=e.originalEvent||e,!g(e))return!0;if(v.parentNode!=D&&d.append(p),e.target!==D){for(var n=e.target;n.parentNode!==D&&n.parentNode;)n=n.parentNode;n.parentNode===D&&n!==v&&(i(e,n)?D.insertBefore(v,n):D.insertBefore(v,n.nextSibling))}else if(i(e,v,!0))for(;v.previousElementSibling&&(i(e,v.previousElementSibling,!0)||0===v.previousElementSibling.offsetHeight);)D.insertBefore(v,v.previousElementSibling);else for(;v.nextElementSibling&&!i(e,v.nextElementSibling,!0);)D.insertBefore(v,v.nextElementSibling.nextElementSibling);return o.dndDragover&&!u(o.dndDragover,e,l())?s():(d.addClass("dndDragover"),e.preventDefault(),e.stopPropagation(),!1)}),d.on("drop",function(e){if(e=e.originalEvent||e,!g(e))return!0;e.preventDefault();var n,t=e.dataTransfer.getData("Text")||e.dataTransfer.getData("text/plain");try{n=JSON.parse(t)}catch(d){return s()}var i=l();return o.dndDrop&&(n=u(o.dndDrop,e,i,n),!n)?s():(n!==!0&&a.$apply(function(){a.$eval(o.dndList).splice(i,0,n)}),u(o.dndInserted,e,i,n),"none"===e.dataTransfer.dropEffect?"copy"===e.dataTransfer.effectAllowed||"move"===e.dataTransfer.effectAllowed?r.dropEffect=e.dataTransfer.effectAllowed:r.dropEffect=e.ctrlKey?"copy":"move":r.dropEffect=e.dataTransfer.dropEffect,s(),e.stopPropagation(),!1)}),d.on("dragleave",function(e){e=e.originalEvent||e,d.removeClass("dndDragover"),n(function(){d.hasClass("dndDragover")||p.remove()},100)})}}]).directive("dndNodrag",function(){return function(e,n,r){n.attr("draggable","true"),n.on("dragstart",function(e){e=e.originalEvent||e,e._dndHandle||(e.dataTransfer.types&&e.dataTransfer.types.length||e.preventDefault(),e.stopPropagation())}),n.on("dragend",function(e){e=e.originalEvent||e,e._dndHandle||e.stopPropagation()})}}).directive("dndHandle",function(){return function(e,n,r){n.attr("draggable","true"),n.on("dragstart dragend",function(e){e=e.originalEvent||e,e._dndHandle=!0})}}).factory("dndDragTypeWorkaround",function(){return{}}).factory("dndDropEffectWorkaround",function(){return{}});
!function(){function t(t){function e(e,l,r,i){function o(){var t=c.querySelector("tbody tr:first-child td:first-child");return t&&!t.style.width}function d(){angular.element(c.querySelectorAll("thead, tbody, tfoot")).css("display",""),t(function(){angular.forEach(c.querySelectorAll("tr:first-child th"),function(t,e){var l=c.querySelector("tbody tr:first-child td:nth-child("+(e+1)+")"),r=c.querySelector("tfoot tr:first-child td:nth-child("+(e+1)+")"),i=l?l.offsetWidth:t.offsetWidth;l&&(l.style.width=i+"px"),t&&(t.style.width=i+"px"),r&&(r.style.width=i+"px")}),angular.element(c.querySelectorAll("thead, tfoot")).css("display","block"),angular.element(c.querySelectorAll("tbody")).css({display:"block",height:r.tableHeight||"inherit",overflow:"auto"});var t=c.querySelector("tbody"),e=t.offsetWidth-t.clientWidth;if(e>0){e-=2;var l=c.querySelector("tbody tr:first-child td:last-child");l.style.width=l.offsetWidth-e+"px"}})}var c=l[0];e.$watch(o,function(t){t&&d()})}return{restrict:"A",link:e}}angular.module("anguFixedHeaderTable",[]).directive("fixedHeader",t),t.$inject=["$timeout"]}();
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("NUSAP").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"@?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("NUSAP").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("NUSAP").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("NUSAP").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("NUSAP").directive("rdWidget",rdWidget);